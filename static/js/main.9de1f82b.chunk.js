(this["webpackJsonpreact-redux-auth-template"]=this["webpackJsonpreact-redux-auth-template"]||[]).push([[0],{33:function(e,a,t){e.exports=t.p+"static/media/logo.5d5d9eef.svg"},34:function(e,a,t){e.exports=t(63)},43:function(e,a,t){},62:function(e,a,t){},63:function(e,a,t){"use strict";t.r(a);var n=t(0),r=t.n(n),l=t(11),o=t.n(l),s=t(6),i=t(3),c=t(30),u=t(7),m={is_logged_in:!1,error_message:"",user:{}},d=Object(s.c)({userReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m,a=arguments.length>1?arguments[1]:void 0;switch(a.type){case"SET_USER":return{is_logged_in:!0,user:Object(u.a)({},a.payload),error_message:m.error_message};case"CLEAR_USER":return{is_logged_in:!1,user:{},error_message:m.error_message};case"SET_ERROR":return Object(u.a)(Object(u.a)({},e),{},{error_message:a.payload});default:return e}},dummyReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=arguments.length>1?arguments[1]:void 0;return a.type,e}}),p=(t(43),t(15)),g=t(9),f=t.n(g),E="https://quark-foamy-canopy.glitch.me",h={get:function(e,a,t){return f.a.get("".concat(E).concat(e),a,t)},delete:function(e,a,t){return f.a.delete("".concat(E).concat(e),a,t)},post:function(e,a,t){return f.a.post("".concat(E).concat(e),a,t)},put:function(e,a,t){return f.a.put("".concat(E).concat(e),a,t)}},w=function(e){return{type:"SET_USER",payload:e}},v=function(e){return{type:"SET_ERROR",payload:e}},b=function(){var e=localStorage.getItem("token");return{Authorization:"Bearer ".concat(e)}},_=t(14),S=/^\w+([.-]?\w+)*@\w+([.-]?\w+)*(\.\w{2,3})+$/,R=function(){var e=r.a.useState(""),a=Object(p.a)(e,2),t=a[0],n=a[1],l=Object(i.b)();return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,"Login"),r.a.createElement(_.a,{initialValues:{email:"",password:""},validate:function(e){var a={};return e.email?S.test(e.email)||(a.email="Invalid email address"):a.email="Email Required",e.password||(a.password="Password Required"),a},onSubmit:function(e,a){var t,r=a.setSubmitting;r(!0),l((t=e,function(e){return new Promise((function(a,n){h.post("/user/login",{email:t.email,password:t.password}).then((function(t){localStorage.setItem("token",t.data.token),e(w(t.data.user)),a(t)})).catch((function(a){401===a.response.status?(e(v("Invalid credentials")),n("Invalid credentials")):(e(v(a.message)),n(a.message))}))}))})).catch((function(e){n(e),r(!1)}))}},(function(e){var a=e.values,n=e.errors,l=e.touched,o=e.handleChange,s=e.handleBlur,i=e.handleSubmit,c=e.isSubmitting;return r.a.createElement("form",{onSubmit:i},r.a.createElement("input",{type:"email",name:"email",onChange:o,onBlur:s,value:a.email,placeholder:"Email"}),r.a.createElement("span",null,n.email&&l.email&&n.email),r.a.createElement("input",{type:"password",name:"password",onChange:o,onBlur:s,value:a.password,placeholder:"Password"}),r.a.createElement("span",null,n.password&&l.password&&n.password),r.a.createElement("button",{type:"submit",disabled:c},"Submit"),r.a.createElement("span",null,t))})))},y=function(){var e=Object(i.b)();return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,"Register"),r.a.createElement(_.a,{initialValues:{first_name:"",email:"",password:""},validate:function(e){var a={};return e.email?S.test(e.email)||(a.email="Invalid email address"):a.email="Email Required",e.password||(a.password="Password Required"),e.first_name||(a.first_name="First name Required"),a},onSubmit:function(a){var t;e((t=a,function(e){return new Promise((function(a){h.post("/user/register",{first_name:t.first_name,email:t.email,password:t.password}).then((function(t){localStorage.setItem("token",t.data.token),e(w(t.data.user)),a(t)})).catch((function(t){e(v(t.message)),a(t)}))}))}))}},(function(e){var a=e.values,t=e.errors,n=e.touched,l=e.handleChange,o=e.handleBlur,s=e.handleSubmit,i=e.isSubmitting;return r.a.createElement("form",{onSubmit:s},r.a.createElement("input",{type:"first_name",name:"first_name",onChange:l,onBlur:o,value:a.first_name,placeholder:"First name"}),r.a.createElement("span",null,t.first_name&&n.first_name&&t.first_name),r.a.createElement("input",{type:"email",name:"email",onChange:l,onBlur:o,value:a.email,placeholder:"Email"}),r.a.createElement("span",null,t.email&&n.email&&t.email),r.a.createElement("input",{type:"password",name:"password",onChange:l,onBlur:o,value:a.password,placeholder:"Password"}),r.a.createElement("span",null,t.password&&n.password&&t.password),r.a.createElement("button",{type:"submit",disabled:i},"Submit"))})))},O=t(33),j=t.n(O),k=(t(62),function(){var e=r.a.useState(!0),a=Object(p.a)(e,2),t=a[0],n=a[1],l=Object(i.c)((function(e){return e.userReducer})),o=l.is_logged_in,s=l.user,c=l.error_message,m=Object(i.b)();return r.a.useEffect((function(){m((function(e){return new Promise((function(a){h.get("/user/profile",{headers:Object(u.a)({},b())}).then((function(t){e(w(t.data)),a(t)})).catch((function(t){401===t.response.status?e({type:"CLEAR_USER"}):e(v(t.message)),a(t)}))}))})).then((function(){n(!1)}))}),[m]),r.a.createElement("div",{className:"App"},r.a.createElement("header",{className:"App-header"},r.a.createElement("img",{src:j.a,className:"App-logo",alt:"logo"}),t?r.a.createElement(r.a.Fragment,null,"loading..."):r.a.createElement(r.a.Fragment,null,o?r.a.createElement(r.a.Fragment,null,r.a.createElement("p",null,"You are logged in"),s&&r.a.createElement(r.a.Fragment,null,r.a.createElement("p",null,s.first_name),r.a.createElement("p",null,s.email)),r.a.createElement("button",{className:"App-link",onClick:function(){m((function(e){return new Promise((function(a){h.post("/user/logout",null,{headers:Object(u.a)({},b())}).then((function(){localStorage.clear(),e({type:"CLEAR_USER"}),a()})).catch((function(t){e(v(t.message)),a()}))}))}))}},"Logout")):r.a.createElement(r.a.Fragment,null,r.a.createElement("p",null,"Signup or signin in"),r.a.createElement(R,null),r.a.createElement(y,null)))),c&&r.a.createElement("p",null,c))});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var C=Object(s.d)(d,Object(s.a)(c.a));o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(i.a,{store:C},r.a.createElement(k,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[34,1,2]]]);
//# sourceMappingURL=main.9de1f82b.chunk.js.map